CC:>--------------------------------------------------------------------
CC: FILE:       pamf.F
CC: HISTORY:
CC:             24sep96-v000a-cet- Created by stic Version
CC:  Id: idl.y,v 1.5 1996/09/24 18:07:08 tull Exp
CC:<--------------------------------------------------------------------

      INTEGER*4 FUNCTION PAMF(
     1                t1_h,                t1 ,
     2                t2_h,                t2 ) 
      IMPLICIT NONE
#include "pamf.inc"
CC:>--------------------------------------------------------------------
CC: ROUTINE:    PAMF
CC: DESCRIPTION: Physics Analysis Module FORTRAN 77 template.
CC:             This is a FORTRAN 77 Physics Analysis Module template
CC:             automatically generated by stic Version
CC:        Id: 
CC:             from pamf.idl.
CC:             Please edit comments and code.
CC: AUTHOR:     cet - C.E. Tull, cetull@lbl.gov
CC: ARGUMENTS:
CC:          IN:
CC:               t1     - Table 1
CC:             t1_h     - Header Structure for t1
CC:       INOUT:
CC:               t2     - Table 2
CC:             t2_h     - Header Structure for t2
CC:         OUT:
CC: RETURNS:    STAF Condition Value
CC:>--------------------------------------------------------------------

      INTEGER*4 I,J

      WRITE(*,*) '########################################'
      WRITE(*,*) '###  PAMF-check tables'
      WRITE(*,*) '########################################'

      WRITE(*,*) ' name = ',T1_H.NAME
     +          ,' nok = ',T1_H.NOK
     +          ,' maxlen = ',T1_H.MAXLEN
c     WRITE(*,*) SCALARS_SPEC
      WRITE(*,*) ' name = ',T2_H.NAME
     +          ,' nok = ',T2_H.NOK
     +          ,' maxlen = ',T2_H.MAXLEN
c     WRITE(*,*) VECTORS_SPEC

      DO I=1,T1_H.NOK
	  IF( (T1(I).ASHORT .NE. I-1)
     +    .OR.(T1(I).AUSHORT .NE. I-1)
     +    .OR.(T1(I).ALONG .NE. I-1)
     +    .OR.(T1(I).AULONG .NE. I-1)
     +    .OR.(T1(I).AOCTET .NE. I-1)
     +    .OR.(T1(I).AFLOAT .NE. I-1)
     +    .OR.(T1(I).ADOUBLE .NE. I-1) )THEN
	     WRITE(*,*) 'ERROR IN T1 (',I,'):'
     +       ,T1(I).ASHORT	,T1(I).AUSHORT
     +       ,T1(I).ALONG	,T1(I).AULONG
     +       ,T1(I).ACHAR	,T1(I).AOCTET
     +       ,T1(I).AFLOAT	,T1(I).ADOUBLE
	  ENDIF
      ENDDO
      WRITE(*,*) '###  checked ',T1_H.NOK,' rows'
      DO I=1,T2_H.NOK
      DO J=1,3
	  IF( (T2(I).BSHORTS(J) .NE. I+J-2)
     +    .OR.(T2(I).BUSHORTS(J) .NE. I+J-2)
     +    .OR.(T2(I).BLONGS(J) .NE. I+J-2)
     +    .OR.(T2(I).BULONGS(J) .NE. I+J-2)
     +    .OR.(T2(I).BOCTETS(J) .NE. I+J-2)
     +    .OR.(T2(I).BFLOATS(J) .NE. I+J-2)
     +    .OR.(T2(I).BDOUBLES(J) .NE. I+J-2) )THEN
	     WRITE(*,*) 'ERROR IN T2 (',I,',',J,'):'
     +       ,T2(I).BSHORTS(J)	,T2(I).BUSHORTS(J)
     +       ,T2(I).BLONGS(J)	,T2(I).BULONGS(J)
     +       ,T2(I).BCHARS(J:J)	,T2(I).BOCTETS(J)
     +       ,T2(I).BFLOATS(J)	,T2(I).BDOUBLES(J)
	  ENDIF
      ENDDO
      ENDDO
      WRITE(*,*) '###  checked ',T2_H.NOK,' rows'

!BUG  call ds2realloctable(t2_h,t2_p,222)

      PAMF=STAFCV_OK
      RETURN
      END
