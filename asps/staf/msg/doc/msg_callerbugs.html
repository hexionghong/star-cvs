<h2>MSG Caller Bugs, or MSG Misuse</h2>

There are several possible ways in which MSG can be misused,
and MSG makes an effort to detect and alert the programmer
of these.


<dl>
<dt>Mixed up Fast Reference IDs<dd>It occasionally happens that an application
specifies a different fast reference ID in a MSG_Enabled or MSG_Enabled_Trace
call than the corresponding Message call, which both have the same prefix and
are intended to refer to the same prefix.  Or, the IDs might match, but the
prefixes themselves disagree.  MSG detects when an ID (non-negative) refers
to a prefix that doesn't match the ASCII prefix specified in the MSG call.
A nice, long "bug message" is then displayed; which should occur "once",
(ie, "once"  in the developement-cycle -- but each time the erroneous call
is made to MSG) after which the programmer should fix the problem (and who
should be glad the thing didn't crash and of being told exactly where to
look!):

<pre>
MSG_CHECK-B1 Program bug in caller.  The given ID: "ID value"
             doesn't select the given prefix: ["specified prefix"]
             The prefix stored as that ID is: ["expected prefix"]
             Note that each message needs to have its own ID variable.
</pre>

While this can be quite annoying if it starts spewing forth in copius
quantities, the alternative is worse.  These should be fixed immediately.
For the sake of efficiency, this check is made only for active, displaying
messages.
Note that this message could also indicate that the wrong number of arguments
were specified in an MSG call (see next item).
<p>
<dt>Wrong number of arguments<dd>It also sometimes happens that a Message
call is changed to a Message_Out call, for example, but the Fast reference
ID isn't removed.  It's important to note that Unix adds hidden arguments to
subroutine calls passing character strings which specify the byte-length
of each passed character string (VMS does not -- it uses character
descriptors, and is spared this difficulty).  An extra argument is mistaken
by the called routine as this character length, and this can sometimes
cause a hang or a crash, since the Unix FORTRAN string routines may
get sorely confused with an ID misused as a string-length.
<p>
Likewise, if an argument is missing, MSG could end up using the Unix-hidden
character-string length-argument as a fast-reference ID or as a line-count.
If used as an ID, the above-described MSG_CHECK-B1 message may appear, and
if used as a line count, the program may even hang or crash.  Unix handling
of FORTRAN FORMAT errors is not robust (an understatement).
<p>

<dt>Failure to properly use Fast Reference IDs where really needed<dd>If Fast Reference IDs are
not properly provided to MSG for frequently-called cases, especially where auto-disabling is
relied upon after some small number of warning messages (ie, if -1 is used in
the wrong place, or if
an ID is not declared SAVE), MSG may have to look up the prefix each time
an MSG call is made.  This is slow and CPU-wasteful, and might be very
difficult to track down (MSG can use a lot of CPU time if misused), if
not for a feature in the MSG Summary Output Table.  This is the column
labelled "Lookups", which gives a count of the number of times each
prefix was looked up by character-string search in the array of stored
prefixes.  If any message listed in the Summary shows more than a few
of these, it should be fixed by correctly specifying a Fast Reference
ID for the high-lookup-count message.

</dl>
