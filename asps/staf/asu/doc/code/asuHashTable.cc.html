<HTML>
<PRE>
<H2>file: asu/src/asuHashTable.cc</H2>


/*:From "A C++ Toolkit" by Jonathan S Shapiro
*:&gt;--------------------------------------------------------------------
*:FILE:		asuHashTable.cpp
*:DESCRIPTION:	C++ Hash Table
*:AUTHOR:	cet - Craig E. Tull, cetull@lbl.gov
*:BUGS:		-- NONE KNOWN --
*:HISTORY:	19aug95-v000a-cet- creation
*:&lt;--------------------------------------------------------------------
*/

#include &lt;osfcn.h&gt;
#include "<A HREF="asuHashTable.hh.html">asuHashTable.hh</A>"

unsigned const RESOURCE_ID_MASK = 0xfffff;

<B>hashTable::<A NAME="hashTable">hashTable(</A>)</B>
{
	for(int i=0; i&lt;NBUCKETS; i++ ){
		bucket[i]=0;
	}
}

<B>hashTable::<A NAME="~hashTable">~hashTable(</A>)</B>
{
	for( int i=0; i&lt;NBUCKETS; i++ ){
		<A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A> p=bucket[i];
		
		while(p) {
			bucket[i]=p-&gt;next;
			delete p;
			p=bucket[i];
		}
	}
}

int
<B>hashTable::<A NAME="hash">hash(</A>register unsigned long key)</B>
{
	unsigned const RESOURCE_ID_MASK=0xfffff;
	
	key &= RESOURCE_ID_MASK;
	
	return ((int)(0x7FF & (key^(key&gt;&gt;11))));
}

void *
<B>hashTable::<A NAME="lookup">lookup(</A>register unsigned long key)</B>
{
	int whichBucket=<A HREF="#hash">hash(</A>key);
	
	<A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A> p=<A HREF="#searchBucketFor">searchBucketFor(</A>bucket[whichBucket], key);
	
	if(!p) return 0;
	
	return p-&gt;value;
}

void
<B>hashTable::<A NAME="mapcar">mapcar(</A>void (*f)(<A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A>))</B>
{
	for (int i=0; i&lt;NBUCKETS; i++ ){
		<A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A> p=bucket[i];
		
		while(p) {
			f(p);
			p=p-&gt;next;
		}
	}
}

<A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A>
<B>hashTable::<A NAME="searchBucketFor">searchBucketFor(</A>register <A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A> p,</B>
		register unsigned long key)
{
	while(p) {
		if(p-&gt;key == key) break;
		p=p-&gt;next;
	}
	return p;
}

<A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A>
<B>hashTable::<A NAME="addElement">addElement(</A>register unsigned long key)</B>
{
	int whichBucket = <A HREF="#hash">hash(</A>key);
	
	<A HREF="asuHashTable.hh.html#pHashEntry">pHashEntry</A> p = new <A HREF="asuHashTable.hh.html#hashEntry">hashEntry</A>(key);
	
	p-&gt;next = bucket[whichBucket];
	if( bucket[whichBucket] ) bucket[whichBucket]-&gt;prev = p;
	bucket[whichBucket] = p;
	
	return p;
}

<P>
<P>
<HR>
<H2>Back to <A HREF="files.html">Source File Index</A></H2><P>
<P><HR>
<H5>C++ to HTML Conversion by <I><A HREF="http://www.usc.edu/dept/robotics/personal/af0a/tools/ctoohtml/ctoohtml.html">ctoohtml</A></I></H5>
















































</PRE>
</HTML>
