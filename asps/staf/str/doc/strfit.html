<pre><h3>SUBROUTINE STRFIT( GENERAL_ERRORS, COUNTING_ERRORS, TRACE_LUN
	                 , Niter_max
	                 , FITF, NPTS, NPAR, X, Y, WY, DA, A
	                 , FLAMDA, SA, CHI2 )</h3>


*  Inputs:
	LOGICAL GENERAL_ERRORS  !If TRUE, the Y errors (weights) are set
                                !by the calling routine and found in WY.
                                !GENERAL_ERRORS overrides COUNTING_ERRORS.
	LOGICAL COUNTING_ERRORS !If TRUE, counting errors (sqrt(Y)) are used.
                                !If FALSE, and GENERAL_ERRORS is FALSE,
                                !constant errors (all = 1) are used.
	INTEGER TRACE_LUN       !If >0, iterations are traced on this LUN.
	INTEGER Niter_max       !Max. no. of iterations to try.
	DOUBLE PRECISION FITF   !Externally defined fit-function.
	EXTERNAL FITF
	INTEGER NPTS            !Number of (X,Y) points to fit FITF to.
	INTEGER NPAR            !Number of adjustable parameters "A" in FITF.
	DOUBLE PRECISION X(*)   !The abscissa values.
	DOUBLE PRECISION Y(*)   !The ordinate values
	DOUBLE PRECISION WY(*)  !The ordinates' weights, if GENERAL_ERRORS
	DOUBLE PRECISION DA(*)  !The differentiation step-size for the "A".

*  Input/Outputs:
	DOUBLE PRECISION A(*)   !The adjustable parameters for FITF,
                                !initialized by the caller.
	DOUBLE PRECISION FLAMDA !The "mixing" parameter, initialized externally
                                !to 1, typically, and determines the relative
                                !mix between the two "types" of fits used
                                !here;  varied as fit improves.  See Bevington.
*  Outputs:
	DOUBLE PRECISION SA(*)  !The fit-error-estimates in the A.
	DOUBLE PRECISION CHI2   !The final Chi-2 per dof of the fit.

*  Description:
*	Fit a function, FITF, to a set of data, (X,Y), with weights WY, and
*	variable parameters A.  From a set of routines in "Data reduction
*	and Error Analysis for the Physical Sciences", P.R. Bevington,
*	McGraw-Hill, 1969.   The FORTRAN has been brought up to date.


</pre>
